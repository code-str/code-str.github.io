<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>OC字符位置转换工具（支持自定义基础逻辑字符串）</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 2rem auto; padding: 0 1rem; }
        .container { background: #f5f5f5; padding: 2rem; border-radius: 8px; }
        h1 { color: #333; text-align: center; }
        .input-group { margin: 1rem 0; }
        label { display: block; margin-bottom: 0.5rem; font-weight: bold; }
        input[type="text"], textarea { width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 4px; resize: vertical; }
        textarea { min-height: 100px; }
        button { background: #007bff; color: white; border: none; padding: 0.8rem 1.5rem; border-radius: 4px; cursor: pointer; font-size: 1rem; }
        button:hover { background: #0056b3; }
        .result { margin-top: 1.5rem; padding: 1rem; background: white; border-radius: 4px; border: 1px solid #eee; }
        .result h3 { margin-top: 0; color: #333; }
        .output { font-family: monospace; font-size: 1rem; white-space: pre-wrap; word-break: break-all; }
        .tip { font-size: 0.9rem; color: #666; margin-top: 0.3rem; }
    </style>
</head>
<body>
    <div class="container">
        <h1>转换小工具</h1>
        
        <!-- 新增：基础逻辑字符串输入框 -->
        <div class="input-group">
            <label for="referStringInput">逻辑字符</label>
            <input
                type="text"
                id="referStringInput"
                placeholder="请输入逻辑字符"
                value=""
            >
        </div>
        
        <div class="input-group">
            <label for="wordInput">输入单词组（用英文逗号分隔）</label>
            <textarea id="wordInput" placeholder="请输入单词组"></textarea>
        </div>
        
        <button onclick="runConversion()">执行转换</button>
        
        <div class="result">
            <h3>转换结果</h3>
            <p><strong></strong><span class="output" id="finalOutput"></span></p>
        </div>
    </div>

    <script>
        /**
         * 功能1：根据字符获取位置（对应OC的 returnIndexWithReferString:charToFind:）
         * @param {string} referString - 基础逻辑字符串
         * @param {string} charToFind - 要查找的单个字符（小写）
         * @returns {number} 位置（从1开始，与OC逻辑一致；找不到返回0）
         */
        function returnIndexWithReferString(referString, charToFind) {
            const index = referString.indexOf(charToFind);
            return index >= 0 ? index + 1 : 0;
        }

        /**
         * 功能2：根据位置获取字符（对应OC的 returnIndexStringWithReferString:index:）
         * @param {string} referString - 基础逻辑字符串
         * @param {number} index - 位置（从1开始）
         * @returns {string} 对应的字符（非法位置返回空）
         */
        function returnIndexStringWithReferString(referString, index) {
            if (index < 1 || index > referString.length) return "";
            return referString.charAt(index - 1);
        }

        /**
         * 功能3：单词转位置字符串（对应OC的 changeToNewWordWithReferString:word:）
         * @param {string} referString - 基础逻辑字符串
         * @param {string} word - 输入单词
         * @returns {string} 每个字符的位置拼接（不足10补0）
         */
        function changeToNewWordWithReferString(referString, word) {
            let newWord = "";
            for (let i = 0; i < word.length; i++) {
                const letter = word[i].toLowerCase(); // 统一转为小写（兼容大写输入）
                const index = returnIndexWithReferString(referString, letter);
                newWord += index < 10 ? `0${index}` : `${index}`;
            }
            return newWord;
        }

        /**
         * 主函数：执行批量转换（对应OC的 begin 方法）
         */
        function runConversion() {
            // 1. 获取用户输入的基础逻辑字符串（去空，默认a-z）
            let referString = document.getElementById("referStringInput").value.trim();
            
            // 2. 获取输入单词数组（去空、去重空格）
            const input = document.getElementById("wordInput").value.trim();
            const words = input.split(",").map(word => word.trim()).filter(word => word);

            // 校验：基础逻辑字符串不能为空
            if (referString.length === 0) {
                alert("逻辑字符不能为空！");
                return;
            }
            // 校验：单词数组不能为空
            if (words.length === 0) {
                alert("请输入有效的单词（用逗号分隔）！");
                return;
            }

            let indexwords = ""; // 位置转字母的拼接结果
            let newWords = "";  // 字符转位置的拼接结果

            // 3. 遍历每个单词执行转换（与OC逻辑一致）
            for (const word of words) {
                // 位置转字母：用单词长度作为位置，获取对应字符
                const indexWord = returnIndexStringWithReferString(referString, word.length);
                indexwords += indexWord;

                // 字符转位置：将单词每个字符转为位置字符串
                const newWord = changeToNewWordWithReferString(referString, word);
                newWords += newWord;
            }

            // 4. 展示结果
            document.getElementById("finalOutput").textContent = `${referString}-${indexwords}-${newWords}`;
        }
        
    </script>
</body>
</html>
